import Head from 'next/head'
import { useEffect, useState } from 'react'
import styles from '../styles/Home.module.css'
import Link from 'next/link'
import { FC } from 'react'
import { Card } from '../components/Card'
import { CoffeeShop } from '../types'

export const Home: FC = () => {
  const [coffeeShops, setCoffeeShops] = useState<CoffeeShop[]>([])

  useEffect(() => {
    async function fetchData() {
      const response = await fetch('/api/shops')
      const data = await response.json()
      setCoffeeShops(data.coffeeShops)
    }

    fetchData()
  }, [])

  return (
    <>
      <Head>
        <title>The Coffee Seeker</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        <ul>
          {coffeeShops.map((shop: CoffeeShop) => (
            <li key={shop.title}>
              <Card>
                <div className={styles.shop}>
                  <h3>{shop.title}</h3>
                  <span>{shop.address}</span>
                  <Link href={shop.website}>Website</Link>
                  <Link href={shop.directions}>Directions</Link>
                </div>
              </Card>
            </li>
          ))}
        </ul>
      </main>
    </>
  )
}

export default Home
